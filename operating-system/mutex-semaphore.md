> 상호배제 : 동시 프로그래밍에서 공유 불가능한 자원의 동시 사용을 피하기 위해 사용되는 알고리즘
>

## 뮤텍스

자원에 대해 한 번에 한 스레드만 접근할 수 있다.

따라서 상호배제를 보장한다.

## 세마포어

한 번에 한 스레드가 아니라 자원에 지정한 개수만큼의 스레드가 동시에 접근할 수 있다.

즉 한 번에 접근할 수 있는 스레드의 수를 제한할 뿐 상호배제를 보장하지는 않는다.

카운팅의 개념이 있어 정해진 수만큼 자원에 접근할 수 있다.

## 세마포어는 동시성 문제를 해결하지 못 한다.

뮤텍스는 공유 자원에 하나의 스레드만 접근할 수 있다. ⇒ 동시성 문제 해결 가능

그런데 세마포어는 여러 개가 접근하는 것이므로 동시성 문제가 발생하지 않을까?

### 그런데 왜 세마포어를 사용할까

- 데이터베이스의 경우 동시에 처리할 수 있는 연결의 수에 제한이 있다(제한을 초과하면 성능 저하 발생) 이러한 제한된 자원에 접근을 조절하여 최적의 성능을 유지한다.
- 네트워크 연결 시, 특정 서버로 요청이 많이 들어올 때 허용 수를 제한하여 서버 과부화를 줄일 수 있다.

즉, 세마포어는 자원에 대한 접근을 제어하여 시스템 자원의 효율적 사용을 보장한다.

하지만 공유 자원의 동시성 문제를 해결하기 위해서는 다른 메커니즘도 함께 사용해야 한다.

## 이진 세마포어와 뮤텍스는 같을까?

이진 세마포어는 공유 자원에 최대 한 번에 한 스레드만 접근할 수 있다.

이러한 점에서는 이진 세마포어와 뮤텍스가 다른 점이 없는 것 같다.

> 이진 세마포어와 뮤텍스는 자원의 소유권 측면에서 차이점을 가지고 있다.
>

### 이진 세마포어 : 자원에 대한 소유권을 가지고 있지 않다.

세마포어에는 “소유권”의 개념이 없다.

따라서 한 스레드가 세마포어를 획득한 상황에서 다른 스레드가 해당 세마포어를 해제할 수 있다.

### 뮤텍스 : 자원에 대한 소유권을 가지고 있다.

뮤텍스에는 “소유권”의 개념이 있다.

즉 한 스레드가 공유 자원을 사용하기 위해 lock을 걸게 되면 다른 스레드는 해당 스레드가 lock을 해제할 때까지 기다려야 한다.

뮤텍스에서는 자원에 대해 lock을 가지고 있는 스레드만이 lock을 해제할 수 있기 때문이다.

## 이진 세마포어와 뮤텍스의 사용용도

> 이진 세마포어는 스레드 간 동기화를 위해 뮤텍스는 상호 배제를 위해 사용한다.
>

### 이진 세마포어

- 스레드간 시점 동기화
- 한 스레드가 자원을 준비하고 다른 스레드가 자원을 사용하는 경우 사용한다.

    즉, 한 스레드가 일을 완료하여 다른 스레드에게 이를 알리는 경우에 이진 세마포어를 사용한다.

    - fork하여 메모리를 복사하는 경우
    - 메모리에 올리는 경우
    - 자식 스레드가 종료하여 이를 부모 스레드에게 알릴 때 세마포어를 사용했다)
    - 이는 fork, load, exit sema에 대해서 다시 알아보자

### 뮤텍스

- 공유 자원에 대해 접근을 보호하기 위해 사용
- 즉 한 스레드가 자원을 잠금하고 사용할 때, 다른 스레드가 접근하지 못 하도록 사용한다.(여러 스레드가 동시에 접근하는 곳을 보호하기 위함)

## 정리

### 1. 뮤텍스와 세마포어의 차이점

- 뮤텍스는 공유 자원에 한 스레드만 접근가능하나 세마포어는 여러 스레드가 접근할 수 있다.
- 뮤텍스는 해당 공유 자원에 대한 소유권을 가지고 있으나 세마포어는 공유 자원에 대한 소유권을 가지고 있지 않다.
- 뮤텍스는 locking 메커니즘으로 lock을 획득한 스레드만이 lock을 해제할 수 있다.

    하지만 세마포어는 signaling 메커니즘으로 lock을 걸지 않은 스레드도 signal을 통해 lock을 해제할 수 있다.


### 2. 이진 세마포어와 뮤텍스의 차이점

이진 세마포어와 뮤텍스 둘 다 공유 자원에 한 스레드만 접근할 수 있다는 점은 동일하지만

이진 세마포어는 lock을 획득하지 않은 스레드도 lock을 해제할 수 있다.

반면에 뮤텍스는 lock을 획득한 스레드만이 lock을 해제할 수 있다.